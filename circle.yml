machine:
  node:
    version: 5.4.0

dependencies:
  override:
    - npm install
  cache_directories:
    - 'node_modules'

test:
  pre:
    - echo "module.exports = {googleMapsKey: ${GOOGLE_MAPS_KEY}, stravaClientId: ${STRAVA_CLIENT_ID}, stravaClientSecret: {$STRAVA_CLIENT_SECRET}, redirectUri: ${REDIRECT_URL}};" > properties.js
  override:
    - npm test && npm run coveralls

deployment:
  production:
    branch: master
    commands:
      - ./bin/deploy.sh ${PWD}
